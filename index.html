<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System ZarzƒÖdzania Danymi</title>
    <meta name="description" content="Profesjonalny system do zarzƒÖdzania danymi i analizƒÖ wynik√≥w">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/performance-table.css">
    <link rel="stylesheet" href="css/management-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1 class="system-title">System ZarzƒÖdzania Danymi</h1>
                <p class="system-subtitle">Profesjonalne rozwiƒÖzanie do wprowadzania i analizy danych</p>
            </div>
        </header>

        <!-- Navigation Bar -->
        <nav class="navigation">
            <div class="nav-container">
                <button type="button" id="show-form" class="nav-btn active">
                    <span class="nav-icon">üìù</span>
                    Wprowadzanie Danych
                </button>
                <button type="button" id="show-analytics" class="nav-btn">
                    <span class="nav-icon">üìä</span>
                    Analiza Wynik√≥w
                </button>
            </div>
        </nav>

        <main class="main-content">
            <!-- Message container for success/error messages -->
            <div id="message-container" class="message-container" style="display: none;"></div>

            <!-- Unified Form Container with Tabs -->
            <div class="unified-form-container" id="main-form-container" style="display: block;">
                <!-- Form Tabs -->
                <div class="form-tabs">
                    <button type="button" class="form-tab active" data-tab="tasks">
                        <span class="tab-icon">üìù</span>
                        Dodawanie Zada≈Ñ
                    </button>
                    <button type="button" class="form-tab" data-tab="subjects">
                        <span class="tab-icon">üìö</span>
                        ZarzƒÖdzanie Przedmiotami
                    </button>
                    <button type="button" class="form-tab" data-tab="categories">
                        <span class="tab-icon">üè∑Ô∏è</span>
                        ZarzƒÖdzanie Kategoriami
                    </button>
                </div>

                <!-- Task Form Tab -->
                <div class="tab-content active" id="tasks-tab">
                    <div class="form-container">
                        <h2>Wprowadzanie Danych</h2>
                        <form id="google-sheets-form" class="google-sheets-form" novalidate>
                        <!-- Task Name field -->
                        <div class="form-group">
                            <label for="task_name" class="form-label">
                                Nazwa zadania <span class="required">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="task_name" 
                                name="task_name" 
                                class="form-control"
                                maxlength="100"
                                required
                                placeholder="Wprowad≈∫ nazwƒô zadania..."
                                autocomplete="off"
                            >
                            <div class="field-error" role="alert"></div>
                            <div class="field-help">Maksymalnie 100 znak√≥w</div>
                        </div>

                        <!-- Description field -->
                        <div class="form-group">
                            <label for="description" class="form-label">
                                Opis <span class="required">*</span>
                            </label>
                            <textarea 
                                id="description" 
                                name="description" 
                                class="form-control form-textarea"
                                maxlength="1000"
                                rows="6"
                                required
                                placeholder="Wprowad≈∫ opis zadania..."
                            ></textarea>
                            <div class="field-error" role="alert"></div>
                            <div class="field-help">Maksymalnie 1000 znak√≥w</div>
                        </div>

                        <!-- Correctness field -->
                        <div class="form-group">
                            <label for="correctness" class="form-label">
                                Poprawno≈õƒá <span class="required">*</span>
                            </label>
                            <select 
                                id="correctness" 
                                name="correctness" 
                                class="form-control form-select"
                                required
                            >
                                <option value="">Wybierz opcjƒô...</option>
                                <option value="Poprawnie">Poprawnie</option>
                                <option value="B≈Çƒôdnie">B≈Çƒôdnie</option>
                                <option value="Czƒô≈õciowo">Czƒô≈õciowo</option>
                            </select>
                            <div class="field-error" role="alert"></div>
                        </div>

                        <!-- Category field -->
                        <div class="form-group">
                            <label for="category" class="form-label">
                                Kategoria <span class="required">*</span>
                            </label>
                            <select
                                id="category"
                                name="category"
                                class="form-control form-select"
                                required
                            >
                                <option value="">Pobieranie kategorii z Google Sheets...</option>
                            </select>
                            <div class="field-error" role="alert"></div>
                            <div class="field-help">Wybierz kategoriƒô z listy</div>
                        </div>

                        <!-- Subject field -->
                        <div class="form-group">
                            <label for="subject" class="form-label">
                                Przedmiot <span class="required">*</span>
                            </label>
                            <select
                                id="subject"
                                name="subject"
                                class="form-control form-select"
                                required
                            >
                                <option value="">Pobieranie przedmiot√≥w z Google Sheets...</option>
                            </select>
                            <div class="field-error" role="alert"></div>
                            <div class="field-help">Wybierz przedmiot z listy</div>
                        </div>

                        <!-- Submit button -->
                        <div class="form-actions">
                            <button type="submit" id="submit-button" class="btn btn-primary">
                                Wy≈õlij
                            </button>
                            <button type="button" id="reset-button" class="btn btn-secondary" onclick="document.getElementById('google-sheets-form').reset();">
                                Wyczy≈õƒá
                            </button>
                        </div>
                    </form>
                    </div>
                </div>

                <!-- Subjects Management Tab -->
                <div class="tab-content" id="subjects-tab">
                    <div class="management-section">
                        <div class="management-header">
                            <h2 class="management-title">üìö ZarzƒÖdzanie Przedmiotami</h2>
                            <p class="management-subtitle">Dodawaj, edytuj i usuwaj przedmioty</p>
                        </div>

                        <!-- Add Subject Form -->
                        <div class="management-form-section">
                            <div class="form-card">
                                <h3 class="form-card-title">‚ûï Dodaj Nowy Przedmiot</h3>
                                <form id="add-subject-form" class="management-form">
                                    <div class="form-group">
                                        <label for="subject-name" class="form-label">
                                            Nazwa Przedmiotu <span class="required">*</span>
                                        </label>
                                        <input 
                                            type="text" 
                                            id="subject-name" 
                                            name="subject_name" 
                                            class="form-control"
                                            maxlength="100"
                                            required
                                            placeholder="np. Matematyka, Historia..."
                                        >
                                        <div class="field-error" role="alert"></div>
                                    </div>

                                    <div class="form-group">
                                        <label for="subject-color" class="form-label">
                                            Kolor
                                        </label>
                                        <input 
                                            type="color" 
                                            id="subject-color" 
                                            name="color" 
                                            class="form-control form-color"
                                            value="#667eea"
                                        >
                                        <div class="field-help">Wybierz kolor dla przedmiotu</div>
                                    </div>

                                    <div class="form-group">
                                        <label for="subject-icon" class="form-label">
                                            Ikona
                                        </label>
                                        <input 
                                            type="text" 
                                            id="subject-icon" 
                                            name="icon" 
                                            class="form-control"
                                            maxlength="10"
                                            value="üìö"
                                            placeholder="np. üìö, üî¨, üìê"
                                        >
                                        <div class="field-help">Ikona emoji dla przedmiotu</div>
                                    </div>

                                    <div class="form-actions">
                                        <button type="submit" class="btn btn-primary">
                                            <span class="btn-icon">üíæ</span>
                                            Dodaj Przedmiot
                                        </button>
                                        <button type="reset" class="btn btn-secondary">
                                            <span class="btn-icon">üîÑ</span>
                                            Wyczy≈õƒá
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Existing Subjects List -->
                        <div class="management-list-section">
                            <div class="list-header">
                                <h3 class="list-title">üìã IstniejƒÖce Przedmioty</h3>
                                <button id="refresh-subjects" class="btn btn-outline">
                                    <span class="btn-icon">üîÑ</span>
                                    Od≈õwie≈º
                                </button>
                            </div>
                            <div class="subjects-list" id="subjects-list">
                                <div class="loading-state">
                                    <div class="loading-spinner"></div>
                                    <span>≈Åadowanie przedmiot√≥w...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Categories Management Tab -->
                <div class="tab-content" id="categories-tab">
                    <div class="management-section">
                        <div class="management-header">
                            <h2 class="management-title">üè∑Ô∏è ZarzƒÖdzanie Kategoriami</h2>
                            <p class="management-subtitle">Dodawaj, edytuj i usuwaj kategorie zada≈Ñ</p>
                        </div>

                        <!-- Add Category Form -->
                        <div class="management-form-section">
                            <div class="form-card">
                                <h3 class="form-card-title">‚ûï Dodaj NowƒÖ Kategoriƒô</h3>
                                <form id="add-category-form" class="management-form">
                                    <div class="form-group">
                                        <label for="category-name" class="form-label">
                                            Nazwa Kategorii <span class="required">*</span>
                                        </label>
                                        <input 
                                            type="text" 
                                            id="category-name" 
                                            name="category_name" 
                                            class="form-control"
                                            maxlength="100"
                                            required
                                            placeholder="np. Algebra, Gramatyka..."
                                        >
                                        <div class="field-error" role="alert"></div>
                                    </div>

                                    <div class="form-group">
                                        <label for="category-subject" class="form-label">
                                            Przedmiot <span class="required">*</span>
                                        </label>
                                        <select 
                                            id="category-subject" 
                                            name="subject_name" 
                                            class="form-control form-select"
                                            required
                                        >
                                            <option value="">Pobieranie przedmiot√≥w...</option>
                                        </select>
                                        <div class="field-error" role="alert"></div>
                                        <div class="field-help">Wybierz przedmiot dla tej kategorii</div>
                                    </div>

                                    <div class="form-group">
                                        <label for="category-difficulty" class="form-label">
                                            Poziom trudno≈õci <span class="required">*</span>
                                        </label>
                                        <select 
                                            id="category-difficulty" 
                                            name="difficulty" 
                                            class="form-control form-select"
                                            required
                                        >
                                            <option value="">Wybierz poziom...</option>
                                            <option value="≈Åatwy">≈Åatwy</option>
                                            <option value="≈öredni">≈öredni</option>
                                            <option value="Trudny">Trudny</option>
                                        </select>
                                        <div class="field-error" role="alert"></div>
                                        <div class="field-help">Okre≈õl poziom trudno≈õci kategorii</div>
                                    </div>

                                    <div class="form-actions">
                                        <button type="submit" class="btn btn-primary">
                                            <span class="btn-icon">üíæ</span>
                                            Dodaj Kategoriƒô
                                        </button>
                                        <button type="reset" class="btn btn-secondary">
                                            <span class="btn-icon">üîÑ</span>
                                            Wyczy≈õƒá
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- Existing Categories List -->
                        <div class="management-list-section">
                            <div class="list-header">
                                <h3 class="list-title">üìã IstniejƒÖce Kategorie</h3>
                                <button id="refresh-categories" class="btn btn-outline">
                                    <span class="btn-icon">üîÑ</span>
                                    Od≈õwie≈º
                                </button>
                            </div>
                            <div class="categories-list" id="categories-list">
                                <div class="loading-state">
                                    <div class="loading-spinner"></div>
                                    <span>≈Åadowanie kategorii...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Dashboard Container -->
            <div class="analytics-dashboard" id="analytics-container" style="display: none;">
                <!-- Analytics Header -->
                <div class="analytics-header">
                    <div class="analytics-title-section">
                        <h1 class="analytics-main-title">üìä Analityka Wynik√≥w</h1>
                        <p class="analytics-subtitle">Wybierz przedmiot aby zobaczyƒá szczeg√≥≈Çowe statystyki i postƒôpy</p>
                    </div>
                </div>
                
                <!-- Main Analytics Layout -->
                <div class="analytics-main-layout">
                    <!-- Left Panel: Large Subject Selection -->
                    <div class="analytics-left-panel">
                        <div class="subject-selection-panel" id="subject-selection-section" style="display: none;">
                            <h2 class="panel-title">üéØ Twoje Przedmioty</h2>
                            <div class="large-subject-buttons" id="subject-buttons" style="display: grid; grid-template-columns: auto auto;">
                                <!-- Large enhanced subject buttons will be inserted here -->
                            </div>
                        </div>
                        
                        <!-- No Data State -->
                        <div class="no-subjects-panel" id="no-subjects-panel" style="display: none;">
                            <div class="no-data-illustration">üìà</div>
                            <h3 class="no-data-title">Brak Danych do Analizy</h3>
                            <p class="no-data-description">Dodaj zadania do Google Sheets, aby zobaczyƒá analitykƒô wynik√≥w wed≈Çug przedmiot√≥w.</p>
                        </div>
                    </div>
                    
                    <!-- Right Panel: Detailed Analytics -->
                    <div class="analytics-right-panel">
                        <div class="analytics-content" id="analytics-content">
                            <div class="welcome-state" id="welcome-state">
                                <div class="welcome-illustration">üëà</div>
                                <h3 class="welcome-title">Wybierz Przedmiot</h3>
                                <p class="welcome-description">Kliknij na przedmiot po lewej stronie, aby zobaczyƒá szczeg√≥≈ÇowƒÖ analizƒô wynik√≥w, kategorii i postƒôp√≥w w nauce.</p>
                                <div class="welcome-features">
                                    <div class="feature-item">
                                        <span class="feature-icon">üìä</span>
                                        <span class="feature-text">Szczeg√≥≈Çowe statystyki</span>
                                    </div>
                                    <div class="feature-item">
                                        <span class="feature-icon">üìà</span>
                                        <span class="feature-text">Analizy postƒôp√≥w</span>
                                    </div>
                                    <div class="feature-item">
                                        <span class="feature-icon">üéØ</span>
                                        <span class="feature-text">S≈Çabe punkty do poprawy</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="loading-state" style="display: none;">
                                <div class="loading-spinner"></div>
                                <div class="loading-text">Analizowanie wynik√≥w...</div>
                            </div>
                        </div>
                    </div>
            </div>


            <!-- Edit Modal -->
            <div class="modal-overlay" id="edit-modal-overlay" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title" id="edit-modal-title">‚úèÔ∏è Edytuj Element</h3>
                        <button class="modal-close" id="close-edit-modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="edit-form">
                            <input type="hidden" id="edit-item-id" name="id">
                            <input type="hidden" id="edit-form-type" name="formType">
                            
                            <!-- Basic name field - will be used for both subjects and categories -->
                            <div class="form-group">
                                <label for="edit-name" class="form-label">
                                    Nazwa <span class="required">*</span>
                                </label>
                                <input 
                                    type="text" 
                                    id="edit-name" 
                                    name="name" 
                                    class="form-control"
                                    maxlength="100"
                                    required
                                >
                                <div class="field-error" role="alert"></div>
                            </div>

                            <!-- Subject-specific fields -->
                            <div class="form-group subject-only" id="edit-color-group" style="display: none;">
                                <label for="edit-color" class="form-label">
                                    Kolor
                                </label>
                                <input 
                                    type="color" 
                                    id="edit-color" 
                                    name="color" 
                                    class="form-control form-color"
                                    value="#667eea"
                                >
                                <div class="field-help">Wybierz kolor dla przedmiotu</div>
                            </div>

                            <div class="form-group subject-only" id="edit-icon-group" style="display: none;">
                                <label for="edit-icon" class="form-label">
                                    Ikona
                                </label>
                                <input 
                                    type="text" 
                                    id="edit-icon" 
                                    name="icon" 
                                    class="form-control"
                                    maxlength="10"
                                    placeholder="np. üìö, üî¨, üìê"
                                >
                                <div class="field-help">Ikona emoji dla przedmiotu</div>
                            </div>

                            <!-- Category-specific fields -->
                            <div class="form-group category-only" id="edit-subject-group" style="display: none;">
                                <label for="edit-subject" class="form-label">
                                    Przedmiot <span class="required">*</span>
                                </label>
                                <select 
                                    id="edit-subject" 
                                    name="subject_name" 
                                    class="form-control form-select"
                                    required
                                >
                                    <option value="">≈Åadowanie przedmiot√≥w...</option>
                                </select>
                                <div class="field-error" role="alert"></div>
                            </div>

                            <div class="form-group category-only" id="edit-difficulty-group" style="display: none;">
                                <label for="edit-difficulty" class="form-label">
                                    Poziom trudno≈õci <span class="required">*</span>
                                </label>
                                <select 
                                    id="edit-difficulty" 
                                    name="difficulty" 
                                    class="form-control form-select"
                                    required
                                >
                                    <option value="">Wybierz poziom...</option>
                                    <option value="≈Åatwy">≈Åatwy</option>
                                    <option value="≈öredni">≈öredni</option>
                                    <option value="Trudny">Trudny</option>
                                </select>
                                <div class="field-error" role="alert"></div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">
                                    <span class="btn-icon">üíæ</span>
                                    Zapisz Zmiany
                                </button>
                                <button type="button" class="btn btn-secondary" id="cancel-edit">
                                    <span class="btn-icon">‚ùå</span>
                                    Anuluj
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </main>

        <footer class="footer">
            <div class="footer-content">
                <p>&copy; 2024 System ZarzƒÖdzania Danymi. Wszystkie dane sƒÖ synchronizowane z Google Sheets.</p>
            </div>
        </footer>
    </div>

    <!-- Loading overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
        <p id="loading-text">Przetwarzanie...</p>
    </div>

    <!-- JavaScript files -->
    <script src="js/config.js"></script>
    <script src="js/googleSheetsDebugger.js"></script>
    <script src="js/loadingManager.js"></script>
    <script src="js/googleSheetsAPI-v2.js"></script>
    <script src="js/analyticsManager.js"></script>
    <script src="js/managementForms.js"></script>
    <script src="js/app-simplified.js"></script>
    
    <!-- App initialization -->
    <script>
        // System ZarzƒÖdzania Danymi - Ready for operation
        console.log('üìä System ZarzƒÖdzania Danymi - Initialized');
        console.log('üí° Use enableGSDebug() to track Google Sheets data retrieval');
    </script>
</body>
</html>
